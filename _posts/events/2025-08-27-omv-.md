> id: https://sspai.com/post/100313

> link: https://sspai.com/post/100313

> title: OMV

# OMV
_Published on Wed, 27 Aug 2025 03:15:03 GMT_

![Article Cover Image](https://cdnfile.sspai.com/2025/08/14/2b4c8330dc209682e80e03aed66aec11.png)  

**Matrix 首页推荐** 

[Matrix](https://sspai.com/matrix) 是少数派的写作社区，我们主张分享真实的产品体验，有实用价值的经验与思考。我们会不定期挑选 Matrix 最优质的文章，展示来自用户的最真实的体验和观点。   
文章代表作者个人观点，少数派仅对标题和排版略作修改。

* * *

我是安小匠，玩电脑玩硬件的创作者。

NAS，除了购买成熟的产品，自己组装也是一种有趣的玩法。我在上一篇文章[《捡配件，勤动手，组装我的第一台 NAS》](https://sspai.com/post/98141)里分享了自己组装 NAS 硬件的经验，那么在完成硬件配置后，就要选择一款用着趁手的 NAS 操作系统。

**我个人选择的是一款老牌的、面向 NAS 的 Linux 发行版——OpenMediaVault（简称 OMV）。**它一开始就是为 NAS 而生，面向家用存储场景，提供了一系列开箱即用的功能（磁盘管理、SMB、NFS 等），更可以通过安装插件来拓展用途。更重要的是，它是开源免费的，没有版权之虞，不用担心授权问题；以 Debian 为基石的它更是广泛兼容各大 x86-64 平台电脑1，不挑硬件。

![](https://cdnfile.sspai.com/2025/08/14/be3f241b19dc155b74bb6865563d8f61.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

展示一下我的 OMV 仪表盘。

OMV 本身采用网页端管理界面，操作清晰易懂。然而相较于[飞牛 OS](https://www.fnnas.com/)这样专注于用户体验的 NAS 操作系统，OMV 的操作逻辑还是复杂了些，初次上手很容易被一环扣一环的操作逻辑弄得不明所以，就连我自己在「折腾」OMV 的过程中也踩过不少坑，折腾了很久才顺利实现 OMV 最基本的功能——文件共享。

就在折腾的过程中，我越来越得心应手，总结了一套行之有效的安装、配置经验，使配置 OMV 的过程更为清晰有章法。如果你也打算将 OMV 用于你的 NAS，那么相信这篇文章可以给你不少帮助。现在我将部署 OMV 的成功经验总结在这里，供你参考，让 OMV 为你所用。

文章要点比较多，大家可以不用着急，一步一步来。

> **ℹ️写在前面**
> 
> 本文不涉及磁盘阵列，所有磁盘均单独挂载。具体原因可以[参看《捡配件，勤动手，组装我的第一台 NAS》](https://sspai.com/post/98141)的「我不组建磁盘阵列」一节。

第一章：准备安装镜像
----------

与 Windows 和各大主流 Linux 发行版一样，OMV 的安装镜像采用 ISO 格式，极大地降低了操作门槛2。在获取 ISO 镜像后，你可以使用你喜欢的方式创建启动盘

### 前往官网下载镜像

OMV 的 ISO 安装镜像文件可以从官方网站下载。

打开[官方网站](https://www.openmediavault.org/)，点击顶部的「Download」打开下载页面，然后**点击「Stable」按钮下载最新的稳定版本**。

![](https://cdnfile.sspai.com/2025/04/30/17899c7d25f6879ed8994f3526aa81d9.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

OMV 的下载页面。

下载得到的文件名类似于这样：`openmediavault_7.4.17-amd64.iso`，镜像大小为 940MB 左右。

### 制作启动盘（以 Ventoy 为例）

将安装镜像制作成启动盘有多种方式，例如使用 [Rufus](https://rufus.ie/zh/)、[Unetbootin](https://unetbootin.github.io/) 等工具创建启动 U 盘，或者使用 UltraISO、Nero 甚至 Windows 自带的刻录工具3刻录启动光盘（需要使用 DVD，因为容量超过了 CD4）。大家可以自行检索。

![](https://cdnfile.sspai.com/2025/05/15/article/54285a0065846b5f1c87d6a4aba57f85.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

功能强大的系统引导工具：Ventoy。（图片来源：[Ventoy 官方网站](https://ventoy.net/cn/screenshot.html)）

笔者选用 [Ventoy](https://www.ventoy.net/cn/) 来制作启动盘，这是一款功能强大的便携式系统引导工具，只需把 ISO 文件拷贝到 U 盘中，然后可以在 Ventoy 的界面中选择你要引导的 ISO。如此就可以实现多个启动镜像共存，无须反复格式化 U 盘。

> **注意：**
> 
> 无论使用哪种制作启动盘的方式，都需要格式化 U 盘，或者擦写你的 DVD-RW 光盘。Ventoy 在首次制作启动盘时也需要格式化。因此务必备份数据，**建议「专盘专用」**14！

以 Ventoy 制作启动盘的操作步骤如下：

-   **第一步：**到 [Ventoy 官方网站](https://ventoy.net/cn/download.html) 下载启动盘制作工具。
-   **第二步：**参考 Ventoy 的[**官方中文教程**](https://ventoy.net/cn/doc_start.html)，制作启动盘。制作过程中，_**原有 U 盘的数据都会被清除**_。  
    最后你的 U 盘会有两个分区：一个 EFI 分区，以及一个卷标为 `Ventoy` 的 exFAT 分区。在 Windows 中，只有第二个分区可见，Ventoy 将从该分区中扫描 ISO 文件。
-   **第三步：**将 OMV 的安装镜像拷贝到 U 盘卷标为 `Ventoy` 分区的根目录。
-   **第四步：**进入 BIOS 设置，让电脑从 U 盘启动电脑。
    -   如果你使用了老式界面的 AMI BIOS（H61 等老平台配备），你可以按左右方向键切换到最后一个标签页，然后在底部的「Boot Override（优先启动设备）」中选择你的 U 盘。
    -   其他类型的 BIOS 操作方法需要你自行检索。
-   **第五步：**成功从 Ventoy 的 U 盘启动电脑后，你就会看到 Ventoy 的菜单，你就可以在列表中看到 OMV 的镜像文件了。选中该镜像文件，然后选择**「以正常模式启动（Boot in normal mode）」**，即可引导进入 OMV 的安装程序。最后，在下一个界面选择「Install」，正式开始安装过程。

第二章：安装 OpenMediaVault
---------------------

由于 OMV 是服务器操作系统，其安装程序并不是使用我们熟悉的鼠标操作的界面，取而代之的是更为「原始」的、基于 ncurses 的界面，式样有点像 DOS 下的图形界面5，只能使用键盘操作。

大家不要被那些蓝背景、灰窗口的界面吓到，尽管放心就好。安装界面经过了精心设计，逻辑清晰，加上非常完备的中文支持，对中文用户非常友好，极大降低了操作门槛。6

安装过程非常简单，具体可以按照以下步骤进行。

### **第一步：语言和键盘选择**

![](https://cdnfile.sspai.com/2025/05/14/5136dafb1f95b198d6bb7e4415c55468.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

语言选择界面。

第一个界面是语言选择（_「Select a language」_），可以直接在菜单中选择简体中文，回车确认。紧接着会要求你选择一个地理位置（用于设置时区等）以及键盘映射，分别选择_「中国」_和_「汉语」_即可。

随后安装程序会自动加载文件、探测网络连接，稍等片刻。

### 第二步：配置网络接口（网卡）

![](https://cdnfile.sspai.com/2025/05/14/c0bda604b2802018bb5fdb7f237b084f.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

选择要使用的网卡。图中，第一张网卡是板载的百兆卡，第二张则是 USB 3.0 扩展卡上的千兆卡。

安装程序会为你自动配置网络，并且连接网络下载更新，这一过程是全自动的，可以减少人为干预。因此，**为了使安装更顺利，建议提前通过网线将 NAS 与路由器连接，且路由器需要支持 DHCP 自动配置 IP 地址**。

然后，在上图的列表中选择你使用的无线网卡，回车确认，随后安装程序会自动联网。

> **ℹ️提示：**
> 
> 事实上，无须网络连接也可以完成 OMV 的安装，但安装时会提示网络问题，需要你手动干预，会使安装过程稍微繁琐一些。如果你无法联网，则在下图的菜单中选择「暂时不配置网络」。

![](https://cdnfile.sspai.com/2025/05/14/f16446c3d4ba279013ce4699021c3c2b.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

无法联网时会出现的菜单，可以选择「暂时不配置网络」进行离线安装。

### 第三步：配置主机名与 `root` 密码

接下来 OMV 会要求你输入**主机名（hostname）**，这将是你的 NAS 在局域网上显示的名字。

![](https://cdnfile.sspai.com/2025/05/14/db3c1b22a54d2b59c58ddf983dda99eb.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

配置主机名。

再下一步就是配置超级用户 `root` 的密码。

root 是 Linux 发行版中的超级用户，几乎可以干任何事情，未经授权使用 root 用户是很危险的。因此我们要给 root 账户设置密码，防止他人非法登录 NAS。

**你需要设置一个强度相对高一些的密码，以保证系统安全**。

![](https://cdnfile.sspai.com/2025/05/14/0a838dfa59b8e19658e05949e22aa535.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

> **ℹ️提示：**
> 
> 务必牢记你输入的密码。后续若需要以 root 权限登录系统进行维护，则会用上这个密码。

### 第四步：选择安装磁盘

安装磁盘的选择，是我必须重点强调的部分。因为 OMV 默认会**清除你的系统盘，将其变为 OMV 专用，只能按照 OMV 自己的方式分区，不支持自行分区**，这与其他操作系统的安装是有根本不同的！

> **⚠️特别注意！**
> 
> 当你开始磁盘分区时，OMV 就会按照其既定的规则来分区，不支持自行修改。_**你选择的目标磁盘数据将会被完全覆盖掉！**_

因此，在继续之前，_**请务必**_：

-   **确保有一块用于安装系统的硬盘已经正确安装**
-   **看清楚对话框中显示的磁盘容量，不要弄错磁盘了**
-   **把所有数据盘全部取出**，以免误操作导致 OMV 覆盖你数据盘的资料

正常情况下，你的电脑应该连接了两块磁盘：你的启动 U 盘，以及将要安装 OMV 的系统盘。所以你会看到下面这个提示：

![](https://cdnfile.sspai.com/2025/05/14/447fbba9b048e742ecfd8b956769c0bb.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

当电脑安装不止一块磁盘时会出现的提示。安装程序会要求你在下一步选择正确的磁盘。

> **⚠️！！！警告！！！⚠️**  
> **如果你只插了启动盘，那么你的启动盘就会被 OMV 的安装程序覆盖掉。**  
> 这是一个大坑！

确认之后，再根据厂家、容量和型号来选择正确的目标磁盘。我用于安装系统的磁盘是 128 GB 的 Intel SSD，因此选择第一项。

![](https://cdnfile.sspai.com/2025/05/14/ba9aa0498b63695ba0cdd70c5237ab56.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

磁盘选择界面，注意别选错了。

分区完成后，安装程序就会正式开始把系统文件复制到磁盘中。

### 第五步：配置软件包管理器

![](https://cdnfile.sspai.com/2025/05/14/b6708e3ffd8435f14a0b350648c76a80.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

选择国内镜像站点。

接下来 OMV 安装程序会要求你选择镜像站点所在的区域，根据你的实际需要选择。建议选择「中国」，可以直接使用国内镜像源，访问速度会快不少。

下一步，安装程序会给出一系列国内镜像源的地址，我首推的是网易（`mirrors.163.com`）、清华 TUNA（`mirrors.tuna.tsinghua.edu.cn`）或中科大（`mirrors.ustc.edu.cn`）。

安装程序还会询问你是否设置 HTTP 代理。如果不需要，直接留空并确认。

### 第六步：在线安装与离线安装

如果你的 NAS 已经正常联网，那么接下来安装程序就会自动联网安装。否则，你会看到下图的这个警告。

**但是，实际上不联网依然可以继续安装 OMV，直接选「是」即可继续安装。**7

![](https://cdnfile.sspai.com/2025/05/14/d1bef1131a7235c7b392467896f6a670.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

离线安装时出现的提示，询问你是否继续安装。

随后，安装程序就会自动安装启动引导器（Grub），随即进行最后的收尾工作。

### 第七步：安装完成

当你看到下面这个提示时，恭喜你，OMV 顺利完成了安装！

![](https://cdnfile.sspai.com/2025/05/14/c1e445b3124f3827b42e68093b50ad2f.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

OMV 安装完成的提示。

**拔掉启动盘**，选择「继续」并回车，等待电脑重启。重启后，电脑将会自动进入 OMV。

### 第八步：重启进入 OMV

重启后，你会看到 OMV 的启动菜单。8等待 5 秒（或直接回车），即可引导进入 OMV：

![](https://cdnfile.sspai.com/2025/05/14/e94ff2f82134edaa4f780ccaf115ed58.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

OMV 的启动菜单。

成功进入系统后，你会看到下面这个画面：

![](https://cdnfile.sspai.com/2025/05/14/c7b18b36980fed95058d4f18660e1ff0.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

OMV 启动成功后出现的文字登录界面。  
由于 OMV 没有桌面环境（图形界面），在这里你只能以类似于 DOS 的命令行来操作

第三章：初始化 OpenMediaVault
----------------------

不要被上一张结尾那张黑黢黢的界面吓到，因为实际上配置 OMV 根本不需要输入命令。开发团队为用户提供了一套功能完备的网页端管理界面，就和路由器、云服务控制台9一样，我们只需要在浏览器中输入 NAS 的 IP 地址即可。

那么我们正式进入下一环节：进入 OMV 的网页管理界面，初始化 OMV 的配置。

> **⚠️注意：**
> 
> **先别急着拔掉显示器**，接下来的几个步骤还离不开显示器。

### 开机前插入数据盘

理论上 SATA 是可以实现热插拔的，这意味着你可以在开机时更换硬盘。但是我使用的 H61 主板似乎存在限制，开机状态下更换硬盘时，操作系统未必能识别到硬盘的变更。因此要在电脑还没启动时装上数据盘。

> **ℹ️提示：**
> 
> 如果电脑已经开机并进入 OMV，**可以先登录你的 root 账户**（_在_ `_<主机名> login:_` _提示符输入_ `_root_`_，然后键入 root 密码并回车。注意密码不会回显）_，然后**执行** `**poweroff**` **命令，即可安全关机**。

### 开机前把你的 NAS 接入局域网中

由于 OMV 本身的配置都有赖于其网页端，**用网线**10将 NAS 连入局域网是必不可少的步骤，务必确保路由器支持 DHCP 功能，可以自动分配 IP 地址。

为了能让 OMV 在开机时自动配置网络，免于手动操作，建议在开机前就将 NAS 连接到路由器上。

### 确认登录 OMV 的 IP 地址，登录管理后台

由于自动分配的 IP 地址往往是随机的，我们还需要确认 OMV 分配到了哪个 IP 地址。

开机，启动进入 OMV。当启动完成后，你会看到黑色的屏幕上显示了当前 OMV 的 IP 地址。**下图红框处** `**enp5s0**` **的地址就是 OMV 在局域网分配的 IP 地址，其中** `**enp5s0**` **对应的是当前连接的有线网卡。**

> **ℹ️提示：**
> 
> **不同电脑的网卡名和 IP 地址不一样，看清楚了。**

![](https://cdnfile.sspai.com/2025/05/15/13020c5b4525a7c8a2f36b14309b07f7.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

红框中的地址为 NAS 的 IP 地址。

然后，在同一局域网的另一台电脑上打开浏览器，访问该 IP 地址，即可打开 OMV 的管理后台：

![](https://cdnfile.sspai.com/2025/05/15/f44eb3e2ab75799306c4b3164173f50d.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

**OMV 管理后台的默认用户名和密码**如下：

默认用户名

admin

密码

openmediavault

### 设置固定 IP 地址

DHCP 分配 IP 地址，意味着每次开机后 NAS 的 IP 地址很有可能「一天一个样」11，显然容易影响 OMV 的使用体验（比如每次进管理后台前，找 NAS 的 IP 地址都要捣鼓半天）。所以我们需要给 NAS 分配固定的 IP 地址。

-   **第一步：**在管理后台左侧，依次点击**「网络」==>「接口」**，你会看到如下图所示的界面。默认情况下这里是没有添加任何项目的。

![image](https://cdnfile.sspai.com/2025/05/15/article/31bcd560f5c474e26e81ba481b446883.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

OMV 的网络接口（网卡）管理页面。

-   **第二步：**点击列表左上角的**「加号」按钮**，在弹出的菜单中选择「以太网」：

![image](https://cdnfile.sspai.com/2025/05/15/article/4a739930033ec4bcc010a75adbb894a8.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

OMV 支持五种不同类型的网络，其中有线网卡对应的是「以太网」。

-   **第三步：**接下来就会打开网卡设置的界面，如下图所示。
    -   **在顶部的「设备」下拉框中，选择你要使用的网卡。**通常格式为「`enp0sxx`」的是板载有线网卡；而名称一长串、以「`enx`」开头的网卡则为独立安装的网卡，图中这个网卡「`enx00e04c6800e1`」是扩展卡上的千兆网卡。12
    -   **在「IPv4」一栏中，将「方式」设为「**`**静态**`**」**，然后依次指定 IP 地址、子网掩码和网关地址。
    -   「IPv6」这一栏则按需设置。如果你不使用或很少使用 IPv6，保持默认设置（「`自动`」）即可。

![image](https://cdnfile.sspai.com/2025/05/15/article/dd9fbbe9055cfde589af15ea0fd8b3c1.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

网卡设置界面，在这里指定你的目标网卡与 IP 地址。

-   **第四步：**设置 DNS。把网页拉到最下面，你会看到「高级设置」一栏。在「DNS 服务器」一栏中填入服务器地址，例如阿里 DNS（`223.5.5.5`）。其他设置保持默认值。

![image](https://cdnfile.sspai.com/2025/05/15/article/a6b7db6cf73f177b7108f7ac3cf50f82.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

在「高级设置」中，指定 DNS 服务器。

-   **第五步：**确认设置。点击页面最底部右下角的**「保存」按钮，**随后会回到网卡列表的页面，并且顶部会出现一个黄色横幅：**「待应用的配置更改」。点击横幅右上角的「✅」图标，应用设置。**

![image](https://cdnfile.sspai.com/2025/05/15/article/add2115c114c936a27793e8a3bfbd8dc.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

此时网卡已经完成配置，但要手动点击横幅上的「✅」按钮才能生效。

稍等片刻，我们的网络设置就生效。接下来，就可以直接用固定的 IP 地址来访问 NAS 了。

> **ℹ️提示：**
> 
> 从现在开始，你就可以拔掉 NAS 的显示信号线了，之后的操作都不需要再使用显示器和键鼠。21

### 修改管理员密码

为了保证 OMV 的安全，网页管理界面的密码也需要重新设置。

在 OMV 管理界面中，点击右上角的「用户」图标，在弹出的菜单中选择「更改密码」，如下图所示： 

![](https://cdnfile.sspai.com/2025/08/23/99fafcb0a9396e65dad1ece92aeea36c.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

然后在弹出的界面中指定新密码即可。

> **ℹ️提示：**
> 
> 不建议设置为与 root 相同的密码。

### 创建用户

SMB/CIFS、FTP 等文件共享协议允许匿名访问，也就是无需登录即可访问 NAS 的共享文件夹。但如果有一些重要的文件，显然你会希望用户在登录后才能访问。

因此，为了让其他设备安全可信地访问 NAS 上的文件，我们还需要新建一个用户。这样，我们就可以在为 OMV 配置文件共享协议时，禁止匿名访问特定的共享文件夹。

-   **第一步：**在左侧的功能列表中，依次点击「用户」==>「用户」，打开「用户管理」界面：

![](https://cdnfile.sspai.com/2025/06/17/5ede2825b371c0dc772bf5b87b2d9703.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

-   **第二步：**点击工具栏上的「带圆圈的加号」按钮，在弹出的菜单中选择「添加」，开始创建用户。随后，指定用户的**【名称】**和**【密码】**，并在**【确认密码】**中再输一次你指定的密码。其他值保持默认不用修改。

![](https://cdnfile.sspai.com/2025/06/17/821f35806d7503e1a4909e4d6b124365.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

本例中，假设用户名为`robin`

确认无误后，拉到最下方点击「保存」，并提交更改。

![](https://cdnfile.sspai.com/2025/06/17/445bf6ed1b182d3136a4895a9dbbfdd5.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

添加后的用户。

在此基础上，**你还可以创建更多的用户**，在之后的操作里给不同的用户指定不同的权限等设置。

第四章：配置文件系统
----------

在 OMV 中，要想用上数据盘，让局域网内的设备访问 NAS 中的数据，需要**「三步走」**：

1.  挂载数据盘的文件系统
2.  设置共享文件夹及其权限
3.  设置 SMB/CIFS 共享，让你局域网的设备能够访问 NAS 上的文件。

**上面三个步骤环环相扣，连接紧密，务必循序渐进一步步操作**。首先第一步就是要挂载文件系统。

### 挂载文件系统（对于已有数据的磁盘）

与飞牛、群晖、威联通 QTS 等主打便捷的 NAS 系统不同的是，**OMV 是不会自动识别并挂载你的数据盘的**，需要你手动在 OMV 的**「文件系统」管理器**中挂载数据盘的分区。

-   **第一步：**在 OMV 的网页端管理界面中，依次点击**「存储器」**\==>**「文件系统」**，你会看到下面这个界面：

![image](https://cdnfile.sspai.com/2025/05/16/article/7dbffc6987cfba8b4c4232e293e26dd9.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

「文件系统」管理界面。现在是空的，还没有挂载文件系统。

-   **第二步：**点击工具栏**「右三角（▶️）」按钮**，进入「挂载」界面，该界面用于挂载你磁盘上已有的分区。
    -   **在「文件系统」下拉框中，选择你要挂载的分区，你可以根据容量和文件系统来判断。**图中的`/dev/sda2`是我笔记本电脑 1TB 硬盘上的数据分区，此前一直在 Windows 下使用，为 NTFS 文件系统。
    -   **「标签」用于直观地标识你挂载的分区**，可以按你的喜好来指定，例如「`数据盘`」「`Notebook HDD`」等。你可以指定多个标签。
    -   「用量警告阈值」可以按需设置。13

![](https://cdnfile.sspai.com/2025/05/16/0f2cf8c2977d734ed61de1999a109b74.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

-   **第三步：**确认无误后，点击「保存」，回到「文件系统」界面。此时网页上还会出现「待应用的配置更改」横幅，点击横幅上的「✅」按钮使设置生效。

如果你还有其他的分区要挂载，则重复上面的步骤。

### 擦除磁盘并创建文件系统（对于新磁盘，或者无须保留数据的磁盘）

如果你购入了新硬盘，或者是要清除原有磁盘的数据并用作 NAS 存储，则可以在磁盘管理界面中，**选中你要清除数据的硬盘，然后点击「橡皮擦（清除磁盘数据）」按钮**。

随后，OMV 会要求你确认。若要继续清除磁盘，则确认即可。

> **⚠️注意：**
> 
> 由于 OMV 的设计，如果不清除**整个磁盘**的数据，则无法在 OMV 中创建文件系统。

完成擦除后，**进入「文件系统」管理器页面，找到「带圆圈的加号」按钮——也就是创建新文件系统的按钮**。**点击后，出现一个菜单**，其中列出了 OMV 支持创建的几个文件系统：

![](https://cdnfile.sspai.com/2025/06/11/eeabf1876eb0428965bcf4d16b47b79c.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

OMV 创建文件系统的菜单，可以选择你需要的文件系统。

不同的文件系统有不同的特性，根据需要选择：

文件系统

特点

BTRFS

非常强大的文件系统，具有稳定的表现和较高的容错率，还支持快照、分卷等高级特性。同时适用于 HDD 和 SSD。

EXT4

Linux 的老牌文件系统，中规中矩，兼容性最强，同时适用于 HDD 与 SSD。

F2FS

专为 SSD 优化的文件系统，可以充分发挥闪存性能，只能在 SSD 使用。

JFS

以日志为特色的文件系统，为面向事务的高性能系统开发，注重性能与可靠性，数据恢复能力强，主要面向企业。

XFS

适合高性能、高并发的存储，如果有数量庞大的设备同时读写 NAS 上的文件系统，则可考虑使用。

**我个人首推 BTRFS**，主要是看重它的灵活性、便利性与容错率。

> **⚠️注意：**
> 
> OMV 创建文件系统，是将**整块硬盘**作为文件系统，**没有分区表**。
> 
> 因此，如果你打算拆下硬盘连接到 Windows 上读数据，那么系统是无法识别的。你只能在 Linux 下手动进行挂载（使用`sudo mount /dev/sdX`）。

随后进入创建文件系统的界面。其中：

-   **【介绍】**14这一栏，选择「`Single`」，表示只使用单个磁盘，不要创建磁盘阵列；
-   **【设备】**这一栏，则选择你要创建文件系统的磁盘。

![](https://cdnfile.sspai.com/2025/06/17/525717b45637e12d531e0649b8691ccb.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

**确认后，OMV 就会立即开始格式化磁盘，随即自动打开「挂载」界面，**以便你立即挂载刚创建的这个文件系统。

第五章：设置「共享文件夹」
-------------

在挂载磁盘后，我们需要在 OMV 的**「共享文件夹」**管理器中，将你已挂载文件系统上的文件夹作为一个「共享文件夹」来配置。有别于我们熟悉的 Windows 共享文件夹，**OMV 的「共享文件夹」实际上是一个个映射：每个「共享文件夹」的条目，都会映射到文件系统上你指定的一个文件夹**。

### 共享文件夹的作用

在配置 SMB/CIFS、NFS 等传统的文件共享功能时，你就可以在「共享文件夹」列表中选择一个条目，将其中的文件共享给网络中的设备。

与此同时，「共享文件夹」还可以用来给 OMV 其他的功能组件提供文件存储。为了防止用户更换磁盘导致路径失效，OMV 不允许功能组件使用绝对路径，只能使用你设置好的「共享文件夹」。高阶的应用（如基于 Docker 的 [openmediavault-compose](https://wiki.omv-extras.org/doku.php?id=omv7:omv7_plugins:docker_compose) 插件）需要你选择你配置好的「共享文件夹」来存储数据。

### 如何添加共享文件夹

-   **第一步：**在 OMV 的网页端管理界面中，依次点击「存储器」==>「共享文件夹」，你会看到下面这个界面：

![](https://cdnfile.sspai.com/2025/06/16/76f57d8d61251a74076a472df278d2cb.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

「共享文件夹」列表，默认情况下这里是空的。我这里已经配置好了文件夹。

-   **第二步：**点击工具栏上的**「带圆圈的加号」按钮**，进入「创建共享文件夹」界面。
    -   **【名称】：**输入共享文件夹的名称，这是我们之后会在 Windows 的「网络（网上邻居）」等局域网共享工具中看到的名称。
    -   **【文件系统】：**选择你在_「挂载文件系统」_这一步中挂载好的文件系统。
    -   **【相对路径】：**指定的是你想把文件系统上的哪一个文件夹共享出去15。要共享整个文件系统，就输入「`/`」（根目录）。
    -   **【权限】**：保持默认即可（`管理员可读写，用户可读写，其他只读`）。

![](https://cdnfile.sspai.com/2025/06/16/57cbde5adf351264ff5691180d25564f.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

确认无误后，点击「保存」，提交更改。

### 设置权限

在使用 NAS 文件共享的过程中，你可能会遇到以下两个麻烦：

-   无法写入文件，操作系统显示「权限不够」，即使你用了正确的用户名和密码来访问共享文件夹；
-   访问共享文件夹时出错，无法进入，同样提示「权限不够」。

这种情况下，我们就需要正确地设置共享文件夹的权限。

-   **第一步：**选中要配置权限的共享文件夹，点击下图中箭头指向的按钮，打开「权限」设置面板。

![](https://cdnfile.sspai.com/2025/08/14/c1bb394c64b8a6b9270e7643423a63ba.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

点击箭头指向的按钮，以打开「权限」设置面板。

-   **第二步：**在「权限」设置面板中，OMV 会罗列设备上所有的用户，以及它们对该文件夹享有的权限。每个用户可以设置三种权限：
    -   「`Read/Write`」：支持读写；
    -   「`Read-only`」：只读；
    -   「`No access`」：禁止访问。
    -   以「`robin`」用户为例，我想允许该用户读写该共享文件夹，那么点击「`Read/Write`」按钮即可。

![](https://cdnfile.sspai.com/2025/08/14/67173e290b63f445f91177a22d35427c.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

在「权限」设置面板中，允许「robin」读写该共享文件夹。

-   **第三步：**设置完成后，OMV 自动返回「共享文件夹」页面。此时依然会弹出黄色横幅，告知我们需要提交更改才能生效。

> **注意：**
> 
> 「权限」设置面板适用于采用 Linux 文件系统的共享文件夹，如 Ext4、BtrFS、XFS 等。
> 
> 对于 NTFS、exFAT 等 Windows 文件系统，即使不设置权限也不影响用户读写文件，在用户通过 SMB/CIFS 匿名访问共享文件夹时也是如此。

### 后续维护

共享文件夹不是一成不变的。**OMV 允许你在创建共享文件夹后，随时修改其指向的文件系统和相对路径。**

例如，你配置了一个名为「`多媒体`」的共享文件夹，「文件系统」设为一块 2 TB 的磁盘 `/dev/sda`。后来你购入了一块 4 TB 的硬盘，创建为 `/dev/sdb` 这个文件系统，那么就可以在「共享文件夹」界面中选中「`多媒体`」文件夹，点击工具栏上的「铅笔」按钮进入编辑界面，随后将「文件系统」设为 `/dev/sdb` 即可。

第六章：配置文件共享协议（SMB/CIFS）
----------------------

大家使用 NAS，最主要的用途应该就是文件共享了。

最为常用的局域网文件共享协议就是 **SMB/CIFS**，是 Windows 默认采用的文件共享协议，配置灵活，支持各种高级特性。后来，[SAMBA 项目](https://www.samba.org/)让该协议实现了跨平台，现在可在 macOS、Linux、Android 等平台中使用。

我个人就是优先推荐使用 SMB/CIFS 的：一方面，OMV 默认支持该协议，开箱即用；另一方面，Windows 原生支持，加之 Linux、Android 等平台都有软件支持该协议，极大降低了不同平台设备访问 NAS 的门槛。

### 启用 SMB/CIFS

OMV 预装了 SMB/CIFS 的支持。在左侧导航栏中，依次展开**「服务」==>「SMB/CIFS」==>「设置」**，打开 SMB/CIFS 的全局设置：

![](https://cdnfile.sspai.com/2025/08/14/7797a25b91860627864ab8978b96c347.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

只需要打开上面的「已启动」开关即可，其他选项保持默认值不用更改。

随后，**勾选最上面的「已启动」复选框，其余设置保持默认值即可**。然后将网页拉到底部，点击「确认」，随即按提示提交更改，即可启动 SMB 服务。

### 将共享文件夹添加到 SMB/CIFS 的共享列表中

在 OMV 中，无论是哪种文件共享协议，你在上一章创建的「共享文件夹」都不会自动共享给网络上的设备；你只有在这些文件共享协议中，手动将共享文件夹加入其中。SMB/CIFS 就是如此。

-   **第一步：**在左侧导航栏中，依次展开**「服务」==>「SMB/CIFS」==>「共享」**，打开 SMB/CIFS 的文件夹共享列表。

![](https://cdnfile.sspai.com/2025/08/23/bfd4f7d67d19831f2f74a0dad896ab7a.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

笔者的 NAS 已经配置了 5 个共享文件夹。

-   **第二步：**点击工具栏上的「带圆圈加号」按钮，开始添加共享，你会看到如下的界面：

![](https://cdnfile.sspai.com/2025/08/23/a33eabebb199393c9a3cd3d18940cc5d.png?imageView2/2/w/1120/q/90/interlace/1/ignore-error/1/format/webp)

「创建共享文件夹」页面。

-   **第三步：点击「共享文件夹」**，会列出你设置的所有共享文件夹。你可以在这里选择你想要共享的文件夹。
-   **第四步：设置可访问性**。在「公开」这个参数中，你可以指定是否让未登录用户（即访客）在文件管理器输入你的主机地址时，看到你共享的文件夹。熟悉 Windows 文件共享的读者应该会有似曾相识的感觉。  
    支持的选项有以下三种，根据你的实际需求选择：
    -   **「否」**：只有用正确的账户登录的用户才能看到，对访客是不可见的。适用于需要保护、只允许授权访问的文件夹。
    -   **「允许访客」**：访客可以看到，适用于你希望与局域网的电脑公开共享的文件夹。
    -   **「仅访客」**：访客可以看到，并且无论是否用账户登录，所有的访问都是以访客的名义。适用于非重要的文件，或者是需要临时在局域网里共享的文件，因为这种方式不能保证安全性。
-   **第四步：**根据你的实际情况，你还可以修改以下参数。_**其余参数保持默认值即可**_。

参数名

说明

只读

启用后，用户将无法创建或修改共享中的文件，只能由你在 OMV 上修改。

启用回收站

默认情况下，在 Windows 中删除共享文件夹上的文件时，是会彻底删除的。打开该选项可以启用「回收站」，防止误删文件。16

传输加密

只允许支持加密的客户端存取共享文件夹，可以保证数据安全。

存储 DOS 属性

打开此项，可以让 OMV 兼容与存储 DOS/Windows 文件系统的扩展属性（系统、只读、隐藏、存档）。如果你使用的系统以 Windows 为主，且有软件依赖于这些属性，可以考虑启用。

允许主机和拒绝主机

白名单和黑名单，可以允许或拒绝特定的主机访问这个共享文件夹。留空则为默认值。

-   **第五步：**设置完成后，OMV 自动返回上一个页面。此时依然会弹出黄色横幅，告知我们需要提交更改才能生效。

### 测试 SMB/CIFS 文件共享

在完成所有 SMB/CIFS 文件共享的设置后，接下来测试共享文件夹是否可访问。你可以进行以下测试，以 Windows 为例：

-   在 Windows 资源管理器中输入主机名或 IP 地址，格式为：`\\<主机名或IP地址>`（如：`\\192.168.2.3`），看看是否能列出所有的共享文件夹（可访问性为「公开」）。
-   对于可访问性设置为「允许访客」或「仅访客」的文件夹，看看是否能正常读取其中的内容（如果没有在上一章的权限设置里，给其对应的「共享文件夹」配置了禁止访问的权限）。
-   对于可访问性设置为「否」的文件夹，看看在资源管理器输入完整路径后，能否弹出用户名和密码的弹窗；并且在输入“第三章：初始化 OpenMediaVault”中添加的用户名及其密码后，看看是否可以正常访问共享文件夹。

如果测试结果一切正常，那么恭喜你，你顺利完成了 OMV 的文件共享配置，现在你可以畅快地使用你的 NAS 了！

常见问题
----

### 问：我有两块磁盘，分别搭载了 NTFS 与 Ext4 文件系统。现在，通过 SMB/CIFS 访问 NAS 时，NTFS 上的文件夹可以正常读写，但是 Ext4 的就不行。

**答：**很正常，这与 NTFS 的机制有关。我之前就才过这个坑。

有别于 Ext4 等 Linux 文件系统，NTFS 在目前的 Linux 发行版中，通过 [NTFS-3G](https://github.com/tuxera/ntfs-3g) 这个项目提供支持。考虑到在 Linux 下使用 NTFS 的用户往往同时使用 Windows，为了保证兼容性，NTFS-3G 挂载 NTFS 分区后，其访问权限要宽松得多，防止权限问题导致 Windows 无法访问 Linux 下创建或修改的文件。

这就意味着，即使没有在 OMV 中为 NTFS 上的「共享文件夹」配置权限，或者是完全以访客身份访问「共享文件夹」时，照样能正常读写文件。

然而，OMV 是一款 Linux 发行版。像 Ext4 这样的 Linux 文件系统，本身就有完备的权限机制，OMV 对「共享文件夹」权限的管理自然是完备的，因此不配置权限就无法写入甚至读取文件。所以你才会遇到上述问题。

### 问：为什么你不使用磁盘阵列（如 RAID）？那你如何保证数据安全？

**答：**简单来说，就是看重灵活性——每块磁盘有不同的分工，独立存储数据，必要时可以更换。而且其中两块磁盘是我使用多年的盘，存储了大量需要共享给多设备的数据。具体原因可以[参看_《捡配件，勤动手，组装我的第一台 NAS_》](https://sspai.com/post/98141)的_「我不组建磁盘阵列」_一节。

当然，不采用磁盘阵列也意味着我要更注重数据安全。目前我采用的是**「3-2-1 备份原则」**：至少保留三份数据副本（一份主份 + 两份备份），保存在两种不同介质上（如 NAS+ 硬盘），且有一份异地存放（例如选择可靠的、支持加密传输的云存储，我选用的是[阿里云盘](https://www.alipan.com/)）。

写在最后
----

在动手完成组装 NAS、初始化配置 OMV 后，我终于有了属于自己的「个人数据中心」，原先分散在三四台电脑上的数据得以集中起来，免去往返不同电脑的麻烦，还有专门的硬盘用于备份手机上的照片、视频等数据。这其中，我收获了不少快乐，有获益于 NAS 集中管理数据的自在感，更有「自己动手丰衣足食」的成就感。

在这一过程中，我动手探索 OMV 的配置，亲手总结行之有效的经验，再通过这篇文章把这些经验分享给愿意使用 OMV 的读者们。若这篇教程能帮助到大家，帮助喜欢 OMV 的读者成功搭建属于自己的 NAS，那就是我莫大的荣幸。

当然，OMV 的潜能远远不止 SMB/CIFS，它还支持更多高级特性，例如 NFS、FTP 等协议，甚至是 Docker Compose 容器等高阶玩法，这些都值得好好发掘。我也会在后续的创作中为大家讲解这些高级玩法。

希望大家都能开心自在玩转 NAS！

\> 关注 [少数派小红书](https://www.xiaohongshu.com/user/profile/63f5d65d000000001001d8d4)，感受精彩数字生活 🍃

\> 实用、好用的 [正版软件](https://sspai.com/mall)，少数派为你呈现 🚀
